#!/usr/bin/env bash

if [ -z "$1" ]; then
    echo "defaulting to iPhone 7 simulator"
    xcodebuild -workspace FitpaySDK.xcworkspace -scheme FitpaySDK-Carthage-iOS -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone 7' test | xcpretty && exit ${PIPESTATUS[0]}
    pod repo update
    xcodebuild -workspace FitpaySDK.xcworkspace -scheme FitpaySDK -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone 7' test | xcpretty && exit ${PIPESTATUS[0]}
else
    xcodebuild -workspace FitpaySDK.xcworkspace -scheme FitpaySDK-Carthage-iOS -sdk iphonesimulator -destination "platform=iOS Simulator,name=$1" test | xcpretty && exit ${PIPESTATUS[0]}
    pod repo update
    xcodebuild -workspace FitpaySDK.xcworkspace -scheme FitpaySDK -sdk iphonesimulator -destination "platform=iOS Simulator,name=$1" test | xcpretty && exit ${PIPESTATUS[0]}
fi
